- content_for :landing do
  = image_tag 'landing-video.jpg', width: '100%'

.row.section.text-center
  %h1 Reg&iacute;strate

.row.section
  .col-xs-12.col-sm-3.text-center
    = link_to registration_new_path(user_type: "organization") do
      = image_tag 'roles/organizations_2x.png', class: 'landing-icon'
      %h3 Organizaciones
    %p Organizaciones legalmente constituidas que ejecutan proyectos

  .col-xs-12.col-sm-3.text-center
    = link_to registration_new_path(user_type: "organization") do
      = image_tag 'roles/groups_2x.png', class: 'landing-icon'
      %h3 Grupos
    %p Colectivos sin figura jurídica que ejecutan proyectos

  .col-xs-12.col-sm-3.text-center
    = link_to registration_new_path(user_type: "investor") do
      = image_tag 'roles/investors_2x.png', class: 'landing-icon'
      %h3 Inversionistas
    %p Organizaciones y personas interesadas en invertir en los proyectos sociales

  .col-xs-12.col-sm-3.text-center
    = link_to registration_new_path(user_type: "collaborator") do
      = image_tag 'roles/collaborators_2x.png', class: 'landing-icon'
      %h3 Colaboradores
    %p Investigadores(as), consultores(as), voluntarios(as) y periodistas interesados(as) en apoyar causas sociales

  .col-md-12.map-landing{:id=>"map"}
    = simple_form_for :tag, :url => root_path(:anchor => "map", :defaults => {:required => false}), :method => :get do |f|
      .row
        .col-md-1
          = image_tag "landing/encuentra_2x.png", class: "img-responsive"
        .col-md-11.padding-text-map
          .row
            .col-md-6
              %p.bright Encuentra
              %p.bright Encuentra proyectos por ubicación geográfica
            .col-md-6.text.right
              =f.label I18n.t('simple_form.placeholders.search'), class: "bright", :required => false
              =f.input :name, collection: @projects, include_black: false,input_html: { "data-placeholder"=> I18n.t('simple_form.placeholders.search'), class: "chosen-select ", tabindex: "2", :onchange=>"show_marker();"}, :label =>false, :required => false
      
      
      =f.label I18n.t('simple_form.placeholders.fields'), class: "yellow", :required => false
      .yellow.glyphicon.glyphicon-chevron-down{:data => {:toggle => 'collapse', :target => '.avanzada'}}
      .row.avanzada.panel-collapse.collapse{"aria-labelledby" => "headingOne", :role => "tabpanel"}
        .col-md-1
        .col-md-3
          =f.label I18n.t('simple_form.placeholders.search_city'), class: "bright", :required => false
          =f.input :city, collection: CITIES, include_black: false,input_html: { "data-placeholder"=> I18n.t('simple_form.placeholders.organization.city'), class: "chosen-select", tabindex: "2"  }, label: false, :required => false
        .col-md-2
          =f.label I18n.t('simple_form.placeholders.search_ageb'), class: "bright", :required => false
          =f.input :ageb, :label =>false, :required => false 
        .col-md-2
          =f.label I18n.t('simple_form.placeholders.search_distrito'), class: "bright", :required => false
          =f.input :distrito, :label =>false , :required => false
        .col-md-2
          =f.label I18n.t('simple_form.placeholders.search_seccion'), class: "bright", :required => false
          =f.input :seccion, :label =>false , :required => false
        .col-md-1.margin-top-button.text-right
          = f.button :submit, "buscar" 
    %div{:id=>"geolocation", :style=>'width: 100%; height: 400px;'}
    .row
      .col-md-2.padding-text-map
        = link_to "ver listado", registration_new_path, :class=>"btn btn-default"

:javascript
  $(document).ready(loadMapLanding);
  var markersArray = [];
  //mostramos en el mapa la ubicacion del usuario
    function centerOnMap(position){
      var array_lat =  "#{raw @array_lat}".substring(1,"#{raw @array_lat}".length-1).split(",");
      var array_lng = "#{raw @array_lng}".substring(1, "#{raw @array_lng}".length-1).split(",");
      var array_name = '#{raw @array_name}'.substring(1, '#{raw @array_name}'.length-1).split(",");
      for(i=0; i< array_lng.length; i++){
       marker = handler.addMarker({
          lat: array_lat[i],
          lng: array_lng[i],
          infowindow: "Proyecto: "+ array_name[i],
          title:  array_name[i]
        });
        markersArray.push(marker);
      }
      if(array_lat[0]+"" == ""){
        handler.map.centerOn(["25.6754382","-100.3483728"]);
      }else{
        handler.map.centerOn([array_lat[array_lat.length-1],array_lng[array_lng.length-1]]);
      }
      
      handler.getMap().setZoom(10);
  }

  